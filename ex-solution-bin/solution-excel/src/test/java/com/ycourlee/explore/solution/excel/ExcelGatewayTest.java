package com.ycourlee.explore.solution.excel;

import ch.qos.logback.core.encoder.ByteArrayUtil;
import cn.afterturn.easypoi.excel.entity.result.ExcelImportResult;
import com.sun.imageio.plugins.common.ReaderUtil;
import com.ycourlee.root.mocks.util.FileUtil;
import org.junit.jupiter.api.Test;
import org.springframework.util.FileCopyUtils;
import org.springframework.util.StreamUtils;

import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.OutputStream;
import java.util.Date;
import java.util.stream.Collectors;

/**
 * @author yongjiang
 * @date 2021.11.16
 */
public class ExcelGatewayTest extends AbstractEnvironment {

    static String encodedExcelStream = "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";

    @Test
    void importExcelMoreTest() throws Exception {
        ExcelImportResult<Object> importResult =
                ExcelGateway.importExcelMore(recoveryFromEncodedString(encodedExcelStream),
                        ExcelRowModelTest.InputBO.class);
        importResult.getList().forEach(System.out::println);
    }

    @Test
    void exportExcelTest() throws Exception {
        FileOutputStream outputStream = new FileOutputStream(TEMP_DIR + "/b.xlsx");
        ExcelImportResult<Object> importResult =
                ExcelGateway.importExcelMore(recoveryFromEncodedString(encodedExcelStream),
                        ExcelRowModelTest.InputBO.class);

        ExcelGateway.exportExcel(outputStream
                , importResult.getList().stream().map(o -> {
                    ExcelRowModelTest.InputBO inputBO = (ExcelRowModelTest.InputBO) o;
                    ExcelRowModelTest.OutputBO outputBO = new ExcelRowModelTest.OutputBO();
                    outputBO.setDate(new Date());
                    outputBO.setId(inputBO.getId());
                    outputBO.setName(inputBO.getName());
                    return outputBO;
                }).collect(Collectors.toList())
                , ExcelRowModelTest.OutputBO.class);
    }
}
